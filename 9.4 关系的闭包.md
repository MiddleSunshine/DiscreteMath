# 9.4 关系的闭包

先扩充两个概念：逆关系和补关系。
$$
假设从集合A到集合B的关系为R，即(a,b) \in R \\
逆关系：{R}^{-1}：如果 (a,b) \in R，则(b,a) \in R \\
补关系：\overline{R}：(a,b) \notin R
$$
再来是一个特殊关系的定义——对角关系：
$$
对于集合A而言，\Delta 表示对交关系，即 \Delta =\{(a,a)|a \in A\}
$$

## 闭包

就是[关系的性质：自反，对称，反对称](https://blog.csdn.net/YQXLLWY/article/details/113480886)，如果集合中关系不满足某一性质时，我们通过将一些不缺失的形式关系补上，就能使新的关系满足该性质，满足该性质的关系就叫做**闭包**。根据满足的性质，又叫做自反闭包，对称闭包，反对称闭包。

比如：
$$
对于集合A=(1,2,3)中的关系：R=\{(1,2),(2,3)\}的传递闭包是什么？\\
答：R \cup \{(1,3)\}
$$


再比如：
$$
假设集合A为整数集，关系为 \\
R=\{(a,b)|a<b \}，\\
求该关系的自反闭包是什么？\\
答：自反闭包为 R \cup \Delta
$$
再来就是：
$$
假设集合A为整数集，关系为：\\
R=\{ (a,b)|a>b \}，\\
求该关系的对称闭包：\\
答：R \cup {R}^{-1}
$$

## 有向图中的路径

先介绍**图**中常见的几个概念：路径，边，回路/圈。

![image-20210131202001402](https://tva1.sinaimg.cn/large/008eGmZEgy1gn7585441oj30dc06ndfx.jpg)

在上面的图片中，边有：`(a,b),(b,c),(b,e),(c,d),(d,a)，(d,b)`

还有由边组成的路径：长度为1的路径`a,b`，长度为2的路径`a,b,c`，长度为3的路径`a,b,c,d`。

同时还有长度为4的回路，或者也可以叫做圈：`a,b,c,d,a`。

然后将上面的概念套用到集合和关系中。
$$
设R是集合A上的关系。从a到b存在一条长为n的路径，当且仅当(a,b) \in R
$$
这个就是将上面图中的有向图中的路径对应到关系中。再来就是传递性。
$$
设R是集合A上的关系。连通性关系R^*由形如(a,b)的有序对构成，使得在关系R中，\\
从顶点a到b之间存在一条长度至少为1的路径。\\
说人话就是：\\
\forall a \forall b \forall c \in A ((a,b) \in R \cap (b,c) \in R \rightarrow (a,c)\in R)
$$
然后上面的定义就是传递性的定义嘛，所以：
$$
关系R的传递闭包等于连通性关系 R^*
$$
[关系的幂的概念见这里](https://blog.csdn.net/YQXLLWY/article/details/113480886)

### 传递闭包与关系的幂

$$
设M_R是定义在n个元素集合上的关系R的0-1矩阵。那么传递闭包R^*的0-1矩阵是\\
{M}_{R^*}=M_R \vee {(M_R)}^{[2]} \vee {(M_R)}^{[3]} \cdots {(M_R)}^{[n]}
$$

上面求矩阵的[布尔幂的方法见这里](https://blog.csdn.net/YQXLLWY/article/details/111305452)。这个公式的证明我不会。

例子：
$$
M_R=\left[ 
\begin{matrix}
1 & 0 & 1\\
0 & 1 & 0\\
1 & 1 & 0
\end{matrix}
\right]\\
同时计算\\
{(M_R)}^{[2]}=\left[
\begin{matrix}
1 & 1 & 1\\ 
0 & 1 & 0\\
1 & 1 & 1
\end{matrix}
\right]
\\
{(M_R)}^{[3]}=\left[
\begin{matrix}
1 & 1 & 1\\ 
0 & 1 & 0\\
1 & 1 & 1
\end{matrix}
\right]
\\
根据公式\\
{M}_{R^*}=M_R \vee {(M_R)}^{[1]} \vee {(M_R)}^{[2]} \vee {(M_R)}^{[3]}=\left[
\begin{matrix}
1 & 1 & 1\\ 
0 & 1 & 0\\
1 & 1 & 1
\end{matrix}
\right]
$$
[如果不想手动算，这里有php的代码](https://blog.csdn.net/YQXLLWY/article/details/113486416)

这里检查一下，上面的计算结果是否是传递闭包。
$$
{M}_{R^*}=\{(1,1),(2,1),(3,1),(2,2),(1,3),(2,3),(3,3)\}
$$




