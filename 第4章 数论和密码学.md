# 4.1 整除性和模算术

$$
a | b，代表b能被a整除 
$$

一些很简单的定理：
$$
如果a|b，a|c，则 a|(b+c)\\
如果a|b，则当 c \in Z，a|bc \\
如果a|b，b|c，则a|c
$$

#### 模算术

$$
如果 a=dq+r，则 q=a\ \textbf{div}\ b，r=a\ \textbf{mod}\ b
$$

#### 同余

$$
a \equiv b (mod\ m) 代表 \\
a\ mod\ m\ = b\ mod\ m
$$

代表a和b，对于m的余数相同。
$$
如果 a \equiv b (mod\ m)，则存在 k \in Z，使得 b=k \times a+m
$$
同余对于加法和乘法来说：
$$
如果：a \equiv b(mod\ m),c \equiv d(mod\ m) \\
则：a+c \equiv b+d (mod\ m)，a \times c \equiv b \times d (mod m)
$$
加法的同余很好理解：
$$
b=a+{k}_{b}m,c=d+{k}_{c}m，\\
则 b+c=a+d+({k}_{b}+{k}_{c})m
$$
乘法理解起来麻烦一点：
$$
bc=(a+{k}_{b}m) \times (d+{k}_{c}m) = ac + m(a{k}_{c}+c{k}_{b}+{k}_{b}{k}_{c}m)
$$
这里千万别把a和c当作变量来理解，而是要想，它的最终结果就是一个数字，而只要是数字，后面的组合就是一个常数。

下面就是一个推论：
$$
(a+b)\ \textbf{mod}\ m= ((a\ \textbf{mod}\ m) + (b\ \textbf{mod}\ m)) \textbf{mod}\ m \\
(ab)\ \textbf{mod}\ m= ((a\ \textbf{mod}\ m) \times (b\ \textbf{mod}\ m)) \textbf{mod}\ m
$$
证明：
$$
a \equiv (a\ mod\ m) (mod\ m),a关于m的余数，肯定同余于其自身，例如 5\ mod\ 2=1，1\ mod\ 2=1，则 5 \equiv 1 (mod 2) \\
同理 b \equiv (b\ mod\ m)，根据上面的加法同余定理可以知道：\\
a+b \equiv (a\ mod\ m)(b\ mod\ m)(mod\ m)，\\
ab \equiv (a\ mod\ m)(b\ mod\ m)(mod\ m)
$$

#### 模m算术简写形式

$$
a+b\ (\textbf{mod}\ m)=a {+}_{m}\ b \\
ab\ (\textbf{mod}\ m)= a {\bullet}_{m}\ b
$$

一些很容易理解的性质：

结合律：
$$
(a {+}_{m}\ b){+}_{m}\ c = a {+}_{m}\ (b{+}_{m}\ c) \\
(a {\bullet}_{m}\ b) {\bullet}_{m}\ c = a {\bullet}_{m} (b\ {\bullet}_{m} c)
$$
交换律：
$$
a {+}_{m} b\ = b {+}_{m}\ a \\
a {\bullet}_{m}\ b\ = b {\bullet}_{m}\ a
$$
分配率：
$$
a {\bullet}_{m}\ (b {+}_{m} c)= (a {\bullet}_{m} b) {+}_{m} (a {\bullet}_{m} c) \\
(a {+}_{m} b) {\bullet}_{m} c = (a {\bullet}_{m}\ c) {+}_{m} (b {\bullet}_{m}\ c)
$$

# 4.3 素数和最大公约数

> 算术基本定理：每个大于1的整数都可以唯一地写为两个或多个素数的乘积。

合数，就是大于1，但是又不是素数的整数。
$$
如果n是一个合数，那么n必有一个素数因子小于等于 \sqrt{n}
$$

#### 埃拉托斯特尼筛法

比如想要知道100以内有哪些数字是素数，就从最小的素数开始，凡是能被该素数整除的，均不是素数，比如从素数2开始，4，6，8，10等，直到100为止，再来是从3开始，6，9，12等，再来是从5开始，10，15，20等，直到所有7为止。至于为什么是7，因为根据上面我们可知，100肯定有一个素数小于等于10，则该值可能为2，3，5，7中的任何一个，然后在恰面的步骤中，我们除外了所有以这些为素数因子的合数，剩下的自然就是100以内的素数了。

#### 梅森素数

就是形如下面的素数：
$$
{2}^{p}-1，且 p 为素数
$$
与其配套的还有一个卢卡斯-莱默尔测试(Lucas-Lehmer)的测试方法，可以判定形如上面的数是否为素数。

#### 最大公约数

$$
d|a，且\ d|b，此时最大的 d 的值就是最大公约数，记为\ gcd(a,b)
$$

所以两个素数的最大公约数就是1。

#### 最小公倍数

$$
a|c，且\ b|c，此时最小的c的值就是最小公约数，记为 lcm(a,b)
$$

据说可以根据上面两个定义得出下面这个结论，但是我不知道怎么证明：

$$
a,b \in {N}^{+}，则 \\
ab=gcd(a,b) \cdot lcm(a,b)
$$

#### 欧几里得算法：最大公约数算法

$$
如果\ a=bq+r,a,b,q,r \in N，则\ gcd(a,b)=gcd(b,r)
$$

证明：
$$
假设 d|a，d|b,则 d|r，因为 d|bq，d|a-bq，所以\ gcd(a,b)=gcd(b,r)
$$
然后在上面的基础上，不断求两个数的公约数为止，直到无法再把数据修改成上面的形式为止，比如求`gcd(287,91)`

```mathematica
287=91*3+14
91=14*6+7
14=7*2 // 没有余数了
```

即`gcd(287,91)=7`

欧几里得算法与上面求模运算之间的关系如下：

```php
function gcd(int $a,int $b){
  	// % 在 php 中代表求模运算，即上面的 mod
    $nextB=$a % $b;
    if (!$nextB){
        return $b;
    }
    return gcd($b,$nextB);
}

print gcd(287,91);
```

#### 贝祖定理

$$
a,b \in {N}^{+},s,t \in N,则\ \exists s \exists t\ gcd(a,b)=sa+tb
$$

这个的证明其实就是上面欧几里得算法的逆步骤：
$$
假设 d|a，d|b，且 gcd(a,b)=d,则\ a=db+r，\\
下面开始拆分：\\
b={k}_{0}r+{n}_{0} \\
r={k}_{1}{r}_{1}+{n}_{1} \\
{r}_{1}={k}_{2}{r}_{2}+{n}_{2} \\
\cdots \\
{r}_{n}={k}_{n}{r}_{n+1} \\
将上面的结果逆序带回去，为了便于理解，下面采用真实数据来展示
$$
首先用欧几里得算法来求`gcd(252,198)`

```mathematica
252=1*198+54
198=3*54+36
54=1*36+18
36=18*2
```

逆着来

```mathematica
18=54-1*36
// 36=198-3*54
18=54-1*(198-3*54)
// 54=(252-1*198)
18=(252-1*198)-1*(198-3*(252-1*198))=4*252-5*198
```

这里需要时候到后面的强归纳定理才能证明，这里我仅仅是想说能理解什么是贝斯定理。

这里还有一个定理：
$$
m \in {N}^{+}，a,b,c,d \in N，如果 ac \equiv bc (mod\ m)，且 gcd(c,m)=1，则\ a \equiv b(mod\ m)
$$
这里为了证明上面的内容，需要先证明下面这个，因为下面经常要称呼到，就称为：
$$
a,b,c \in {N}^{+},且\ gcd(a,b)=1，且\ a|bc，则 a|c \tag{引理2}
$$
证明：
$$
因为\ gcd(a,b)=1，所以 \exists s\exists t\ sa+tb=1，\\
两边都 \times c \\
sac+tbc=c，因为\ a|bc，所以a|tbc，且a|sac，所以 a|(sac+tbc)，所以 a|c
$$
根据上面的证明，将最开始的证明写成下面的形式：
$$
因为 ac \equiv bc\ (mod\ m)，则 m|(ac-bc)，则 m|(a-b)c \\
根据上面的引理2，m|(a-b)，\\
则 a \equiv b\ (mod\ m)
$$
这里可能有人会奇怪，为什么
$$
ac \equiv bc\ (mod\ m)，则 m|(ac-bc)
$$
想想同余是什么意思？
$$
ac={k}_{0}m+d \\
bc={k}_{1}m+d \\
ac-bd=({k}_{0}-{k}_{1})m \\
则自然\\
m|(ac-bd)
$$
那么反过来成立吗？
$$
如果 m|(a-b)，则 a \equiv b\ (mod\ m)
$$
试想一下模算术的定理：
$$
a=b+{k}_{0}m \\
b=a-{k}_{0}m 
$$

# 4.4 求解同余方程

#### 线性同余方程

$$
ax \equiv b\ (mod\ m)，其中，m \in {N}^{+}，a,b \in N，x为变量，这样的方程称为线性同余方程
$$

首先，这是个方程，所以x是变量，剩下的就是在确定a,b,m的值之后，确定x的可选值有哪些。解体思路是这样的：



